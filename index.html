<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- ØªÙ„ÙˆÙŠÙ† Ø´Ø±ÙŠØ· Ø§Ù„Ù…ØªØµÙØ­ -->
    <meta name="theme-color" content="#b71c1c">
    <title>Ø¯Ø¹ÙˆØ© Ø£Ø¨Ø·Ø§Ù„ Ø§Ù„Ø­ÙƒØ§ÙŠØ© | Ø§ØªØ­Ø§Ø¯ Ø·Ù„Ø§Ø¨ ØªØ­ÙŠØ§ Ù…ØµØ±</title>
    
    <!-- Ø§Ù„Ø®Ø·ÙˆØ· ÙˆØ§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@500;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø²ÙŠÙ†Ø© (Confetti) -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        /* Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù† */
        :root {
            --primary: #b71c1c;
            --primary-dark: #8a1515;
            --bg-color: #f3f4f6;
            --text-color: #1f2937;
            --success: #10b981;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }

        body {
            font-family: 'Cairo', sans-serif;
            margin: 0; padding: 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e5e7eb 100%);
            min-height: 100vh;
            display: flex; justify-content: center; align-items: center;
        }

        /* Ø§Ù„ÙƒØ§Ø±Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .card {
            background: white;
            width: 100%; max-width: 500px;
            padding: 30px 20px;
            border-radius: 24px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.08);
            border-top: 6px solid var(--primary);
            text-align: center;
        }

        /* Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ */
        .countdown-container {
            display: flex; justify-content: center; gap: 8px; margin-bottom: 25px;
            background: #fff1f1; padding: 10px; border-radius: 12px; border: 1px solid #ffe4e4;
        }
        .time-box { text-align: center; width: 60px; }
        .time-val { font-size: 20px; font-weight: 900; color: var(--primary); line-height: 1; display: block; }
        .time-label { font-size: 10px; color: #d32f2f; font-weight: bold; }
        .colon { font-size: 20px; color: var(--primary); font-weight: bold; align-self: flex-start; margin-top: -2px; }

        /* Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ÙˆØ§Ù„Ù†ØµÙˆØµ */
        h1 { margin: 0 0 5px; color: var(--primary); font-weight: 900; font-size: 26px; }
        p.subtitle { color: #6b7280; font-size: 14px; margin-bottom: 20px; }

        /* Ø§Ù„ÙÙˆØ±Ù… */
        .input-group { margin-bottom: 15px; text-align: right; }
        label { display: block; font-weight: 700; font-size: 14px; color: #374151; margin-bottom: 8px; }
        
        input, select {
            width: 100%; padding: 14px; border: 2px solid #e5e7eb; border-radius: 12px;
            font-family: 'Cairo'; font-size: 15px; background: #f9fafb; transition: 0.3s;
        }
        input:focus, select:focus {
            border-color: var(--primary); background: white; box-shadow: 0 0 0 4px rgba(183,28,28,0.1);
        }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± (Ø¹Ø¶Ùˆ / Ø²Ø§Ø¦Ø±) */
        .toggle-container { display: flex; gap: 10px; margin-bottom: 20px; }
        .radio-wrapper { flex: 1; position: relative; }
        .radio-wrapper input { position: absolute; width: 100%; height: 100%; opacity: 0; cursor: pointer; z-index: 2; }
        .radio-btn {
            display: flex; align-items: center; justify-content: center; gap: 8px;
            padding: 12px; background: white; border: 2px solid #e5e7eb; border-radius: 12px;
            color: #6b7280; font-weight: bold; transition: 0.2s;
        }
        .radio-wrapper input:checked + .radio-btn {
            border-color: var(--primary); background: #fff1f1; color: var(--primary);
        }

        /* Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© */
        .extra-fields { display: none; /* Ù…Ø®ÙÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ */ }
        .fade-in { animation: fadeIn 0.4s ease forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .btn {
            width: 100%; padding: 16px; border: none; border-radius: 14px;
            font-family: 'Cairo'; font-size: 16px; font-weight: 700;
            cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px;
            transition: transform 0.1s; text-decoration: none; margin-bottom: 12px;
        }
        .btn:active { transform: scale(0.98); }
        
        .btn-main { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); color: white; box-shadow: 0 4px 15px rgba(183,28,28,0.25); }
        .btn-download { background: var(--success); color: white; box-shadow: 0 4px 15px rgba(16,185,129,0.25); }
        .btn-share { background-color: #3b82f6; color: white; box-shadow: 0 4px 15px rgba(59, 130, 246, 0.25); }
        .btn-cal { background: #fff; color: #374151; border: 2px solid #e5e7eb; }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø¬Ø¯ÙŠØ¯ Ù„Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© */
        .btn-reset { 
            background: #f9fafb; 
            color: #4b5563; 
            border: 2px solid #e5e7eb; 
            margin-top: 10px;
        }
        .btn-reset:hover {
            background: #f3f4f6;
            border-color: #d1d5db;
        }

        /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ (Loader) */
        .spinner {
            width: 24px; height: 24px; border: 3px solid rgba(255,255,255,0.3);
            border-top-color: white; border-radius: 50%; animation: spin 0.8s linear infinite; display: none;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* Ù‚Ø³Ù… Ø§Ù„Ù†ØªØ§Ø¦Ø¬ */
        #result-area { display: none; padding-top: 20px; border-top: 2px dashed #e5e7eb; margin-top: 20px; }
        canvas { width: 100%; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }

        /* Ø§Ù„ÙÙˆØªØ± */
        .footer { margin-top: 25px; border-top: 1px solid #e5e7eb; padding-top: 20px; }
        .fb-icon {
            width: 45px; height: 45px; background: #e7f5ff; color: #1877f2;
            border-radius: 50%; display: inline-flex; align-items: center; justify-content: center;
            font-size: 22px; text-decoration: none; transition: 0.2s;
        }
        .fb-icon:hover { background: #1877f2; color: white; }
    </style>
</head>
<body>

    <div class="card">
        <!-- Ø§Ù„Ø¹Ø¯Ø§Ø¯ -->
        <div class="countdown-container" id="countdown">
            <div class="time-box"><span class="time-val" id="d">00</span><span class="time-label">ÙŠÙˆÙ…</span></div>
            <div class="colon">:</div>
            <div class="time-box"><span class="time-val" id="h">00</span><span class="time-label">Ø³Ø§Ø¹Ø©</span></div>
            <div class="colon">:</div>
            <div class="time-box"><span class="time-val" id="m">00</span><span class="time-label">Ø¯Ù‚ÙŠÙ‚Ø©</span></div>
            <div class="colon">:</div>
            <div class="time-box"><span class="time-val" id="s">00</span><span class="time-label">Ø«Ø§Ù†ÙŠØ©</span></div>
        </div>

        <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ -->
        <div id="form-area">
            <h1>Ø£Ø¨Ø·Ø§Ù„ Ø§Ù„Ø­ÙƒØ§ÙŠØ© ğŸ‡ªğŸ‡¬</h1>
            <p class="subtitle">Ø³Ø¬Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø¢Ù† Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ø¹ÙˆØ© Ø§Ù„Ø±Ø³Ù…ÙŠØ©</p>

            <form id="inviteForm">
                
                <!-- Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© -->
                <div class="input-group">
                    <label>Ù‡Ù„ Ø£Ù†Øª Ø¹Ø¶Ùˆ ÙÙŠ Ø§Ù„Ø§ØªØ­Ø§Ø¯ØŸ</label>
                    <div class="toggle-container">
                        <div class="radio-wrapper">
                            <input type="radio" name="type" value="Member" onchange="toggleForm(true)">
                            <div class="radio-btn"><i class="fa-solid fa-check-circle"></i> Ù†Ø¹Ù…ØŒ Ø¹Ø¶Ùˆ</div>
                        </div>
                        <div class="radio-wrapper">
                            <input type="radio" name="type" value="Guest" onchange="toggleForm(false)" checked>
                            <div class="radio-btn"><i class="fa-regular fa-user"></i> Ù„Ø§ØŒ Ø²Ø§Ø¦Ø±</div>
                        </div>
                    </div>
                </div>

                <!-- Ø§Ù„Ø§Ø³Ù… -->
                <div class="input-group">
                    <label>Ø§Ù„Ø§Ø³Ù… Ø«Ù„Ø§Ø«ÙŠ</label>
                    <input type="text" name="name" id="username" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§..." required maxlength="30">
                </div>

                <!-- Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© (Ù…Ø®ÙÙŠØ© Ù„Ù„Ø²ÙˆØ§Ø±) -->
                <div id="extra-fields" class="extra-fields">
                    <div class="input-group">
                        <label>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ (14 Ø±Ù‚Ù…)</label>
                        <input type="tel" name="national_id" placeholder="Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ..." pattern="[0-9]{14}">
                    </div>
                    
                    <div class="input-group">
                        <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                        <input type="tel" name="phone" placeholder="01xxxxxxxxx" pattern="[0-9]{11}">
                    </div>

                    <div class="input-group">
                        <label>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</label>
                        <select name="governorate">
                            <option value="" disabled selected>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©...</option>
                            <option value="Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©">Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©</option>
                            <option value="Ø§Ù„Ø¬ÙŠØ²Ø©">Ø§Ù„Ø¬ÙŠØ²Ø©</option>
                            <option value="Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©">Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©</option>
                            <option value="Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©">Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©</option>
                            <option value="Ø§Ù„Ø¯Ù‚Ù‡Ù„ÙŠØ©">Ø§Ù„Ø¯Ù‚Ù‡Ù„ÙŠØ©</option>
                            <option value="Ø§Ù„Ø´Ø±Ù‚ÙŠØ©">Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</option>
                            <option value="Ø§Ù„ØºØ±Ø¨ÙŠØ©">Ø§Ù„ØºØ±Ø¨ÙŠØ©</option>
                            <option value="Ø§Ù„Ø¨Ø­ÙŠØ±Ø©">Ø§Ù„Ø¨Ø­ÙŠØ±Ø©</option>
                            <option value="Ø§Ù„Ù‚Ù„ÙŠÙˆØ¨ÙŠØ©">Ø§Ù„Ù‚Ù„ÙŠÙˆØ¨ÙŠØ©</option>
                            <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>Ø§Ù„Ù„Ø¬Ù†Ø© Ø§Ù„ØªØ§Ø¨Ø¹ Ù„Ù‡Ø§</label>
                        <select name="committee">
                            <option value="" disabled selected>Ø§Ø®ØªØ± Ø§Ù„Ù„Ø¬Ù†Ø©...</option>
                            <option value="Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©">Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©</option>
                            <option value="Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©">Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ÙˆØ§Ù„Ø¯ÙˆÙ„ÙŠØ©</option>
                            <option value="Ø§Ù„ØªÙ†Ø¸ÙŠÙ… ÙˆØ§Ù„Ù…Ø±Ø§Ø³Ù…">Ø§Ù„ØªÙ†Ø¸ÙŠÙ… ÙˆØ§Ù„Ù…Ø±Ø§Ø³Ù…</option>
                            <option value="Ø§Ù„ØªØ¯Ø±ÙŠØ¨ ÙˆØ§Ù„ØªØ·ÙˆÙŠØ±">Ø§Ù„ØªØ¯Ø±ÙŠØ¨ ÙˆØ§Ù„ØªØ·ÙˆÙŠØ±</option>
                            <option value="Ø§Ù„Ù…ÙƒØªØ¨ Ø§Ù„Ø§Ø¹Ù„Ø§Ù…ÙŠ">Ø§Ù„Ù…ÙƒØªØ¨ Ø§Ù„Ø§Ø¹Ù„Ø§Ù…ÙŠ</option>
                            <option value="Ø§Ù„ØªØ®Ø·ÙŠØ· ÙˆØ§Ù„Ù…ØªØ§Ø¨Ø¹Ø©">Ø§Ù„ØªØ®Ø·ÙŠØ· ÙˆØ§Ù„Ù…ØªØ§Ø¨Ø¹Ø©</option>
                            <option value="Ø§Ù„Ø«Ù‚Ø§ÙØ© ÙˆØ§Ù„Ø§Ø«Ø§Ø±">Ø§Ù„Ø«Ù‚Ø§ÙØ© ÙˆØ§Ù„Ø§Ø«Ø§Ø±</option>
                            <option value="Ø°ÙˆÙŠ Ø§Ù„Ù‡Ù…Ù…">Ø°ÙˆÙŠ Ø§Ù„Ù‡Ù…Ù…</option>
                            <option value="Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©">Ø§Ù„Ù„Ø¬Ù†Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©</option>
                            <option value="Ø§Ù„Ø§Ø³ØªØ¯Ø§Ù…Ø©">Ø§Ù„Ø§Ø³ØªØ¯Ø§Ù…Ø© ÙˆØ§Ù„ØªØ­ÙˆÙ„ Ø§Ù„Ø£Ø®Ø¶Ø±</option>
                        </select>
                    </div>
                </div>

                <button type="submit" class="btn btn-main" id="submitBtn">
                    <span id="btnText">Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¯Ø¹ÙˆØ© âœ¨</span>
                    <div class="spinner" id="loader"></div>
                </button>
            </form>
        </div>

        <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø© -->
        <div id="result-area">
            <canvas id="inviteCanvas"></canvas>
            
            <a id="downloadLink" class="btn btn-download" download>
                <i class="fa-solid fa-download"></i> ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©
            </a>
            
            <!-- Ø²Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© (Ø³ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· Ø¹Ù†Ø¯ Ø§Ù„Ø¯Ø¹Ù…) -->
            <button id="shareBtn" class="btn btn-share" onclick="shareInvite()" style="display: none;">
                <i class="fa-solid fa-share-nodes"></i> Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ø¹ Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡
            </button>
            
            <a id="calendarLink" href="#" target="_blank" class="btn btn-cal">
                <i class="fa-regular fa-calendar-check"></i> Ø­ÙØ¸ Ø§Ù„Ù…ÙŠØ¹Ø§Ø¯
            </a>

            <!-- Ø²Ø± Ø¹Ù…Ù„ Ø¯Ø¹ÙˆØ© Ø¬Ø¯ÙŠØ¯Ø© Ø¨ØªØµÙ…ÙŠÙ… Ø¬Ø¯ÙŠØ¯ -->
            <button onclick="location.reload()" class="btn btn-reset">
                <i class="fa-solid fa-rotate-right"></i> Ø¹Ù…Ù„ Ø¯Ø¹ÙˆØ© Ø¬Ø¯ÙŠØ¯Ø©
            </button>
        </div>

        <div class="footer">
            <a href="https://www.facebook.com/Students.union.long.live.eg/?locale=ar_AR" target="_blank" class="fb-icon">
                <i class="fa-brands fa-facebook-f"></i>
            </a>
            <p style="font-size:12px; color:#9ca3af; margin-top:10px;">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â© Ø§ØªØ­Ø§Ø¯ Ø·Ù„Ø§Ø¨ ØªØ­ÙŠØ§ Ù…ØµØ±</p>
        </div>
    </div>

    <script>
        // --- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… ---
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxXmedbBpS1r3kFf34SGNnU50LqL8-2p0WwpBfwYGbloeahMf16MzCygdCK57dfHOe2/exec';
        const IMG_SRC = 'invite.jpg';
        const EVENT_DATE = new Date('February 7, 2026 14:30:00').getTime();
        let canvasDataUrl = ''; // Ù…ØªØºÙŠØ± Ù„ØªØ®Ø²ÙŠÙ† Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©

        // 1. ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
        const updateTimer = () => {
            const now = new Date().getTime();
            const diff = EVENT_DATE - now;

            if (diff < 0) {
                document.getElementById('countdown').innerHTML = '<span style="color:#b71c1c; font-weight:bold;">âœ¨ Ø¨Ø¯Ø£ Ø§Ù„Ø­ÙÙ„! âœ¨</span>';
                return;
            }

            document.getElementById('d').innerText = Math.floor(diff / (1000 * 60 * 60 * 24));
            document.getElementById('h').innerText = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            document.getElementById('m').innerText = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            document.getElementById('s').innerText = Math.floor((diff % (1000 * 60)) / 1000);
        };
        setInterval(updateTimer, 1000);
        updateTimer();

        // 2. Ø¥Ø¹Ø¯Ø§Ø¯ Ø±Ø§Ø¨Ø· Ø§Ù„ØªÙ‚ÙˆÙŠÙ…
        const calUrl = `https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent("Ø£Ø¨Ø·Ø§Ù„ Ø§Ù„Ø­ÙƒØ§ÙŠØ© - Ø§ØªØ­Ø§Ø¯ Ø·Ù„Ø§Ø¨ ØªØ­ÙŠØ§ Ù…ØµØ±")}&dates=20260207T143000/20260207T180000&details=${encodeURIComponent("Ø­ÙÙ„ Ø£Ø¨Ø·Ø§Ù„ Ø§Ù„Ø­ÙƒØ§ÙŠØ©")}&location=${encodeURIComponent("Ù…Ø±ÙƒØ² Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø´Ø¨Ø§Ø¨ÙŠØ© Ø¨Ø§Ù„Ø¬Ø²ÙŠØ±Ø©")}&sf=true&output=xml`;
        document.getElementById('calendarLink').href = calUrl;

        // 3. Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø­Ù‚ÙˆÙ„ (Ø¹Ø¶Ùˆ / Ø²Ø§Ø¦Ø±)
        window.toggleForm = (isMember) => {
            const extra = document.getElementById('extra-fields');
            const inputs = extra.querySelectorAll('input, select');
            
            if (isMember) {
                extra.style.display = 'block';
                extra.classList.add('fade-in');
                inputs.forEach(i => i.setAttribute('required', 'true'));
            } else {
                extra.style.display = 'none';
                inputs.forEach(i => i.removeAttribute('required'));
                inputs.forEach(i => i.value = '');
            }
        };

        // 4. Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ÙÙˆØ±Ù…
        document.getElementById('inviteForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const btn = document.getElementById('submitBtn');
            const loader = document.getElementById('loader');
            const btnText = document.getElementById('btnText');
            
            btnText.style.display = 'none';
            loader.style.display = 'block';
            btn.disabled = true;

            const formData = new FormData(this);
            formData.append('timestamp', new Date().toLocaleString());

            fetch(SCRIPT_URL, { 
                method: 'POST', 
                body: formData,
                mode: 'no-cors' 
            })
            .then(() => {
                generateAndShowInvite();
            })
            .catch(err => {
                console.error('Network Error, proceeding anyway:', err);
                generateAndShowInvite();
            });
        });

        // 5. Ø±Ø³Ù… Ø§Ù„Ø¯Ø¹ÙˆØ©
        function generateAndShowInvite() {
            const name = document.getElementById('username').value;
            const canvas = document.getElementById('inviteCanvas');
            const ctx = canvas.getContext('2d');
            const image = new Image();
            image.src = IMG_SRC;

            image.onload = function() {
                canvas.width = image.width;
                canvas.height = image.height;

                ctx.drawImage(image, 0, 0);
                
                ctx.font = 'bold 110px "Cairo"'; 
                ctx.fillStyle = '#000000';      
                ctx.textAlign = 'center';       
                
                ctx.fillText(name, canvas.width / 2, 900); 

                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†ØªÙŠØ¬Ø©
                document.getElementById('form-area').style.display = 'none';
                document.getElementById('result-area').style.display = 'block';
                
                // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙˆØ§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
                canvasDataUrl = canvas.toDataURL('image/png');
                
                // Ø¥Ø¹Ø¯Ø§Ø¯ Ø²Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
                const dLink = document.getElementById('downloadLink');
                dLink.href = canvasDataUrl;
                dLink.download = `Ø¯Ø¹ÙˆØ© - ${name}.png`;

                // ÙØ­Øµ Ø¯Ø¹Ù… Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø²Ø±
                if (navigator.share) {
                    document.getElementById('shareBtn').style.display = 'flex';
                }

                // Ø§Ù„Ø§Ø­ØªÙØ§Ù„
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
                
                document.getElementById('loader').style.display = 'none';
                document.getElementById('btnText').style.display = 'block';
            };
        }

        // 6. Ø¯Ø§Ù„Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
        async function shareInvite() {
            const name = document.getElementById('username').value.trim();
            if (navigator.share) {
                try {
                    const blob = await (await fetch(canvasDataUrl)).blob();
                    const file = new File([blob], `Ø¯Ø¹ÙˆØ© - ${name}.png`, { type: blob.type });
                    await navigator.share({
                        title: 'Ø£Ø¨Ø·Ø§Ù„ Ø§Ù„Ø­ÙƒØ§ÙŠØ©',
                        text: `Ø£Ù†Ø§ Ø¬Ø§Ù‡Ø² Ù„Ø­Ø¶ÙˆØ± Ø­ÙÙ„ Ø£Ø¨Ø·Ø§Ù„ Ø§Ù„Ø­ÙƒØ§ÙŠØ©! Ø¯ÙŠ Ø¯Ø¹ÙˆØªÙŠ Ø¨Ø§Ø³Ù…: ${name} ğŸ‡ªğŸ‡¬`,
                        files: [file]
                    });
                } catch (err) {
                    console.log('Error sharing:', err);
                }
            }
        }
    </script>
</body>
</html>